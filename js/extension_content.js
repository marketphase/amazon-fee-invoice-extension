(()=>{"use strict";const e=JSON.parse('{"extension_type":"chromane","mode":"prod","browser":"chrome","after_install_url":"https://staxxer.com/en/thank-you-for-installing-the-staxxer-extension/"}'),t=new class{constructor(e){this.config=e}write(...e){"prod"!==this.config.mode&&console.log(...e)}write_method_call({obj:e,class_name:t,method_name:n,args:r,output:a,error:o,stub:i,stack:s,ignore:c}){if(!c&&"prod"!==this.config.mode){let c="eggshell";c=i?"yellow":o?"red":"white",console.groupCollapsed("%c "+t+"."+n,`color: ${c}`),console.log("this:"),console.log(e),console.log("input:");for(var l=0;l<r.length;l++)console.log(r[l]);console.log(r),console.log("output:"),console.log(a),o&&console.log(s),console.groupEnd()}}}(e),n=new class{async debounce(e,t,n){let r=Date.now();this.debounce_calls[e]=r,await this.wait(t),this.debounce_calls[e]===r&&n()}dig(e,t,n){e.add(n);let r=Object.keys(n);for(let a=r.length,o=0;o<a;o++){let a=r[o],i=n[a];if(i&&!e.has(i))if("string"==typeof i)console.log(t.join("."),a,i);else if("object"==typeof i){let n=JSON.parse(JSON.stringify(t));n.push(a),this.dig(e,n,i)}}}detect_changes(e,t,n){let r=0;new MutationObserver((()=>{Date.now(),r=Date.now()})).observe(e,{attributes:!0,childList:!0,subtree:!0}),setInterval((()=>{}),t),n()}inject_js(){let e=document.createElement("script");e.src=chrome.runtime.getURL("/js/injected.js"),document.documentElement.append(e)}get_iframe_src(){return"dev"===this.config.mode?"http://localhost:2010/":chrome.runtime.getURL("/pages/app/index.html")}constructor(e){this.debounce_calls={},this.stubs=[],this.config=e}get_url(e){return chrome.runtime.getURL(e)}async wait(e){return new Promise((t=>{setTimeout(t,e)}))}decode_json(e){try{return JSON.parse(e)}catch(e){return null}}clone(e){try{return JSON.parse(JSON.stringify(e))}catch(e){return null}}is_undefined(e){return void 0===e}list_is_empty(e){return 0===e.length}object_is_empty(e){return 0===Object.keys(e).length}async fetch_json(e,t){let n=await fetch(e,t),r=await n.text();try{return JSON.parse(r)}catch(e){return null}}async fetch_text(e){let t=await fetch(e);return await t.text()}async wait_for_ready_state_complete(){for(;;){if("complete"===document.readyState)return;await this.wait(200)}}async wait_for_element(e){for(let t=0;t<1e3;t++){let t=document.querySelector(e);if(t)return t;await this.wait(100)}}simulate(e,t){e.dispatchEvent(new Event(t,{bubbles:!0}))}html_to_element(e){let t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}bg_fetch(e,t){return new Promise((n=>{chrome.runtime.sendMessage({name:"fetch_json",data:{url:e,data:t}},(e=>{n(e)}))}))}create_iframe_wrap(e){let t=new Promise((t=>{let n=r=>{if(r.data&&"iframe_ready"===r.data.name&&e.contentWindow===r.source){let e=r.source;window.removeEventListener("message",n),t(this.create_window_wrap(window,e))}};window.addEventListener("message",n)}));return{exec:(e,n)=>t.then((t=>t.exec(e,n)))}}create_window_wrap(e,t){let n=[];return e.addEventListener("message",(async e=>{if(e.data){let t=e.data.name,r=e.data.meta,a=e.data.data;"exec_result"===t&&r&&r.response&&n[r.request_id]&&n[r.request_id](a.result)}})),{exec:(e,r)=>new Promise((a=>{let o=n.length;n.push(a);let i={request_id:o,request:!0};t.postMessage({name:e,meta:i,data:r},"*")}))}}create_window_api(e){window.addEventListener("message",(async t=>{if(t.data){let r=t.data.name,a=t.data.meta,o=t.data.data;if(e[r]){try{var n=await e[r](o)}catch(e){n=null}t.source&&t.source.postMessage({name:"exec_result",meta:{response:!0,request_id:a.request_id},data:{result:n}},"*")}}}))}create_runtime_api(e){chrome.runtime.onMessage.addListener((function(t,n,r){if(e[t.name]){t.data&&t.data._sender&&(t.data._sender=n);try{let n=e[t.name](t.data);n&&n.then?n.then(r).catch((e=>{r(null)})):r(n)}catch(e){r(null)}}else r(null);return!0}))}runtime_exec(e,n){return new Promise((r=>{chrome.runtime.sendMessage({name:e,data:n},(function(e){chrome.runtime.lastError?(t.write("runtime_last_error",chrome.runtime.lastError),r(null)):r(e)}))}))}tab_exec(e,n,r){return new Promise((a=>{chrome.tabs.sendMessage(e,{name:n,data:r},(function(e){chrome.runtime.lastError?(t.write("runtime_last_error",chrome.runtime.lastError),a(null)):a(e)}))}))}parse_rows(e){for(var t=[],n=null,r=e[0],a=1;a<e.length;a++){n={};for(var o=0;o<r.length;o++)n[r[o]]=e[a][o];t.push(n)}return t}get_methods(e){return Object.getOwnPropertyNames(e).filter((t=>"function"==typeof e[t]))}wrap_class(e,n){n=n||[];let r=t,a=this,o=e.name;this.get_methods(e.prototype).forEach((t=>{let i=e.prototype[t];e.prototype[t]=function(){let e={ignore:n.includes(t),obj:this,class_name:o,method_name:t,args:Array.from(arguments),stub:!1},s=a.stubs;if(s&&s[0]&&s[0].class_name===o&&s[0].method_name===t)return e.stub=!0,e.output=s[0].output,s.splice(0,1),r.write_method_call(e),e.output;try{e.output=i.apply(this,arguments)}catch(t){e.error=!0,e.stack=t.stack,e.output=null}return e.output&&e.output.then?e.output=new Promise((t=>{e.output.then((n=>{e.output=n,r.write_method_call(e),t(n)})).catch((n=>{e.error=!0,e.stack=n.stack,e.output=null,r.write_method_call(e),t(null)}))})):r.write_method_call(e),e.output}}))}set_stubs(e){this.stubs=e}post_window_message(e,t,n){e.postMessage({name:t,data:n},"*")}blob_to_base64(e){return new Promise((t=>{const n=new FileReader;n.onloadend=()=>{t(n.result)},n.readAsDataURL(e)}))}download_string(e,t){var n=new Blob([e],{type:"text/plain"}),r=URL.createObjectURL(n),a=document.createElement("a");document.body.appendChild(a),a.setAttribute("style","display: none"),a.href=r,a.download=t,a.click(),window.URL.revokeObjectURL(r)}download_blob(e,t){var n=URL.createObjectURL(e),r=document.createElement("a");document.body.appendChild(r),r.setAttribute("style","display: none"),r.href=n,r.download=t,r.click(),window.URL.revokeObjectURL(n)}find(e,t,n){for(var r=0;r<e.length;r++)if(e[r][t]===n)return e[r];return null}update_object(e,t){Object.keys(t).forEach((n=>{null!==e[n]&&"object"==typeof e[n]?this.update_object(e[n],t[n]):e[n]=t[n]}))}rows_to_data_arr(e){for(var t=[],n=null,r=e[0],a=1;a<e.length;a++){n={};for(var o=0;o<r.length;o++)n[r[o]]=e[a][o];t.push(n)}return t}to_data_url(e){return new Promise((t=>{var n=new XMLHttpRequest;n.onload=function(){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n.response)},n.open("GET",e),n.responseType="blob",n.send()}))}}(e),r=new class{constructor(){this.dom_parser=new DOMParser}parse_fba_core_data_table_html(e){let t={},n=this.dom_parser.parseFromString(e,"text/html");return t.buttons=[],t.table_data=Array.from(n.querySelectorAll("tr")).map((e=>{let n={},r=e.querySelector("#view_invoice_button-announce");if(r){let e={};Object.keys(r.dataset).forEach((t=>{e[t]=r.dataset[t]})),e.value=r.getAttribute("value"),t.buttons.push(e),n.button_data=e}return n.fields=Array.from(e.querySelectorAll(".info")).map((e=>e.innerText.trim())),n})),t}};class a{constructor(){}async inject_css(){document.documentElement.append(n.html_to_element("<style>#chromane_cover {\n  display: none;\n\n  position: fixed;\n  z-index: 7000;\n\n  top: 0px;\n  left: 0px;\n  width: 100%;\n  height: 100%;\n\n  background-color: rgba(0, 0, 0, 0.75);\n}\n\n#chromane_cover.active {\n  display: block;\n}\n\n#chromane_iframe_container {\n  display: block !important;\n  position: fixed;\n  z-index: 8000;\n  top: 0px;\n  height: 100%;\n  left: calc(100%);\n  width: calc(100% - 200px);\n\n  box-shadow: 3px 0px 6px rgba(0, 0, 0, 0.16), 3px 0px 6px rgba(0, 0, 0, 0.23);\n\n  transition: all 0.4s ease;\n}\n\n#chromane_iframe_container.chromane-wide {\n  right: -660px;\n  width: 660px;\n}\n\n#chromane_iframe_container.active {\n  left: 200px;\n}\n\n#chromane_iframe_container iframe {\n  position: relative;\n  z-index: 400;\n\n  display: block;\n\n  height: 100%;\n  width: 100%;\n\n  border: none;\n}\n\n#chromane_iframe_container.chromane-hidden {\n  display: none !important;\n}\n\n#chromane_iframe_toggle_button {\n  position: absolute;\n  z-index: 200;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  top: 100px;\n  left: -30px;\n  height: 50px;\n  width: 30px;\n\n  background-color: #1c1c1c;\n  box-shadow: 3px 0px 6px rgb(0 0 0 / 16%), 3px 0px 6px rgb(0 0 0 / 23%);\n  cursor: pointer;\n\n  border-top-left-radius: 4px;\n  border-bottom-left-radius: 4px;\n}\n\n#chromane_iframe_container .chromane_chevron_left {\n  display: block;\n}\n\n#chromane_iframe_container.active .chromane_chevron_left {\n  display: none;\n}\n\n#chromane_iframe_container .chromane_chevron_right {\n  display: none;\n}\n\n#chromane_iframe_container.active .chromane_chevron_right {\n  display: block;\n}\n\n/* overrides */\n\n.chromane-present-mode .g-user-name {\n  filter: blur(5px);\n}\n\n.chromane-present-mode .g-avatar {\n  filter: blur(15px);\n}\n\n.chromane-present-mode .g-user-username {\n  filter: blur(5px);\n}\n\n.chromane-present-mode .b-story-item {\n  filter: blur(15px);\n}\n\n.chromane-present-mode .b-profile__header__cover-img {\n  filter: blur(40px);\n}\n\n.chromane-present-mode .m-type-post {\n  filter: blur(40px);\n}\n\n/**/\n\n/**/\n</style>"))}init(){this.inject(),this.inject_css();let e=document.querySelector("#sendFormBean").outerHTML,t=r.parse_fba_core_data_table_html(e);this.iframe_wrap.exec("set",["nav_info",{active_page_name:"table"}]),this.iframe_wrap.exec("set",["table_data",t.table_data]),this.iframe_wrap.exec("set",["buttons",t.buttons]),n.create_window_api({get_pdf_blob:async e=>{let t={endDate:e.enddate,fileType:e.filetype,filterName:e.filtername,vatInvoiceNumber:e.invoice,payeeRegistrationNumber:e.payeeregistrationnumber,documentVersionId:e.value},r=(await n.fetch_json(`https://${location.hostname}/tax/view-seller-fee-invoice-execute`,{headers:{accept:"*/*","content-type":"application/json"},body:JSON.stringify(t),method:"POST",mode:"cors",credentials:"include"})).url,a=await fetch(r);return await a.blob()},close:()=>{document.querySelector("#chromane_iframe_container").classList.toggle("active")}})}inject(){document.documentElement.appendChild(n.html_to_element('\n\n            <div id = "chromane_iframe_container" class = "not-active" style = "display: none" >\n\n                <div id = "chromane_iframe_toggle_button" >\n                    \n                    <svg class = "chromane_chevron_left" style="width:24px;height:24px" viewBox="0 0 24 24">\n                        <path fill="white" d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z" />\n                    </svg>\n                    \n                    <svg class = "chromane_chevron_right" style="width:24px;height:24px" viewBox="0 0 24 24">\n                        <path fill="white" d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" />\n                    </svg>\n\n                </div>\n\n            </div>\n\n        '));var e=document.createElement("iframe");e.name=JSON.stringify({context:"sidebar",url:location.href,hostname:location.hostname}),this.iframe_wrap=n.create_iframe_wrap(e),e.src=chrome.runtime.getURL("/pages/extension_app/index.html"),console.log("iframe",e),document.querySelector("#chromane_iframe_container").appendChild(e),document.querySelector("#chromane_iframe_toggle_button").addEventListener("click",(function(){console.log("click"),document.querySelector("#chromane_iframe_container").classList.toggle("active")}))}}n.wrap_class(a,[]);let o=new a;n.create_window_api(o),o.init()})();